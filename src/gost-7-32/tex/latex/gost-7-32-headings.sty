\ProvidesPackage{gost-7-32-headings}[2022/01/28 GOST 7.32-2017]

\RequirePackage{titlesec}
\RequirePackage{titling}
\RequirePackage{setspace}
\RequirePackage{chngcntr}

\RequirePackage{gost-7-32-counters}

%
% Set custom formatting to well-known LaTeX commands: section, subsection and subsubsection
%
\titleformat{\section}[runin]{\large \bfseries}{\thesection}{0.5em}{}[\newline \indent]
\titlespacing{\section}{1.25cm}{0.5em}{0cm}

\titleformat{\subsection}[runin]{\normalsize \bfseries}{\thesubsection}{0.5em}{}[\newline \indent]
\titlespacing{\subsection}{1.25cm}{0.5em}{0cm}

\titleformat{\subsubsection}[runin]{\normalsize \bfseries}{\thesubsubsection}{0.5em}{}[\newline \indent]
\titlespacing{\subsubsection}{1.25cm}{0.5em}{0cm}

%
% Make special headings, that have their own formatting rules:
% - centered
% - all-caps
% - bold
%
% Only three of them must appear in TOC: introduction, conclusion and references
%
\newcommand{\introduction}{
    \addcontentsline{toc}{section}{ВВЕДЕНИЕ}
    \begin{center}
        \bfseries\large
        ВВЕДЕНИЕ
    \end{center}
}

\newcommand{\conclusion}{
    \addcontentsline{toc}{section}{ЗАКЛЮЧЕНИЕ}
    \begin{center}
        \bfseries\large
        ЗАКЛЮЧЕНИЕ
    \end{center}
}

\newcommand{\references}{
    \addcontentsline{toc}{section}{СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ}
    \begin{center}
        \bfseries\large
        СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ
    \end{center}
}

\newcommand{\essay}{
    \begin{center}
        \bfseries\large
        РЕФЕРАТ
    \end{center}
}

\newcommand{\definitions}{
    \begin{center}
        \bfseries\large
        ОПРЕДЕЛЕНИЯ
    \end{center}
}

\newcommand{\abbreviations}{
    \begin{center}
        \bfseries\large
        ОБОЗНАЧЕНИЯ И СОКРАЩЕНИЯ
    \end{center}
}

\newcommand{\defsabbrs}{
    \begin{center}
        \bfseries\large
        ОПРЕДЕЛЕНИЯ, ОБОЗНАЧЕНИЯ И СОКРАЩЕНИЯ
    \end{center}
}

%
% Appendices headings. Appendices have autoincrementing number, 
% that is represented with russian letter.
% This heading must appear in TOC
%
\newcounter{appendixcnt}
\renewcommand{\theappendixcnt}{\AlphRus{appendixcnt}}
\setcounter{appendixcnt}{0}

\renewcommand{\appendix}[1]{
    % Join tables and figures counters with appendices counter 
    % strictly before incrementing it
    % It is necessary to reset these counters after incrementing
    % appendices counter and prevent numbering shifting
    \counterwithin{table}{appendixcnt}
    \counterwithin{figure}{appendixcnt}
    
    % Now I can increment appendices counter and use it
    \stepcounter{appendixcnt}
    
    \addcontentsline{toc}{section}{ПРИЛОЖЕНИЕ \theappendixcnt. #1}
    \begin{center}
        \bfseries\large
        ПРИЛОЖЕНИЕ \theappendixcnt
        
        #1
    \end{center}
}
